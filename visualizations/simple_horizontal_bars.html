<!DOCTYPE HTML>
<meta charset="utf-8">
<html>
  <head>
    <title>D3 Playground</title>
    <script src="../vendor/d3.js" charset="utf-8"></script>
  </head>
  <style>

    #chart {
      /* So we can see where the chart borders are: */
      border: 1px solid black;
      background-color: #eefefa;
      fill: #eefefa;
    }
    .bar-background {
      /* margin-top: 17px;
      background-color: #F0F3F2;
      */

      fill: #F0F3F2;
      height: 30px;
    }

    .bar-background:first-of-type {
      margin-top: 0;
    }

    .data-bar {
      height: 30px;
    }
    .label {
      font-family: 'Helvetica';
      fill: black;
    }
    /*
      MY COLORS:

      green: 5ECB00
      blue: 01B9DA
      orange: FF9100
      yellow: FFD200
      red: CD212E
    */

  </style>

  <body>
    <h1>Simple Horizontal Bars</h1>
    <p class="description">Not exactly a bar chart. Here, we have several metrics that are measured on a percentage basis, where 100% on each metric is the ideal goal. The purpose of this graph is to show how the metrics compare to each other -- which ones are they doing good on, and which metrics need improvement?</p>

    <ul>TODO:
      <li>display labels</li>
      <li>responsive & onload transition</li>
      <li>use logarithmic data --> 0..100 scale (?)</li>
    </ul>


    <div id="chart"></div>


    <script>
      var toPx = function(num) { return num + "px";}

      var data = [
        {x: 30, name: "Math", color: "#5ECB00"},
        {x: 60, name: "English", color: "#01B9DA"},
        {x: 12, name: "Chemistry", color: "#FF9100"},
        {x: 80, name: "History", color: "#FFD200"},
        {x: 30, name: "Art", color: "#CD212E"}
      ];

      var margins = {
        left: 75,
        right: 50,
        top: 50,
        bottom: 50
      }

      var chartDim = {width: 500, height: 300 }
      var dimensions = {
        width: chartDim.width - margins.left - margins.right,
        height: chartDim.height - margins.top - margins.bottom
      }

      var barDim = {
        height: 30
      }

      //ToDo: update this to be logarithmic transform of our actual data to the
      // 0-100 range
      // will have to play around with data to see how well this works
      // maxX should really be the highest possible value on our scale
      // for now we'll assume percentages and use 100;
      var maxX = 100;

      var xScale = d3.scale.linear()
                    .domain([0, maxX])
                    .range([0, dimensions.width]);

      //ToDo: Update graph to use yScale instead of manually setting bar thickness and padding
      var yScale = d3.scale.linear()
                     .domain([0, data.length])
                     .range([0, chartDim.height]);

      var chart = d3.select("#chart").append("svg")
        .style({
          width: toPx(chartDim.width),
          height: toPx(chartDim.height)
        });

      var groups = chart.selectAll("g")
        .data(data)
        .enter()
          .append("g")
          .attr("class", "bar")

          var backgroundBars = groups.append("rect")
            .attr("class", "bar-background")
            .attr("width", chartDim.width)
            .attr("x", margins.left)
            .attr("y", function(d,i) {
              return yScale(i);
            })
            // now append the inner div that provides our data view.
            // ToDo: the width of this should slide in on load, it would look cool
            // would be an update transition

      var dataBars = groups.append("rect")
              .attr("class", "data-bar")
              .attr("x", margins.left)
              .attr("y", function(d,i) {
                return yScale(i);
              })
              .attr("height", barDim.height)
              .attr("width", function(d) {
                return toPx(xScale(d.x));
              })
              .attr("fill", function(d) {
                return d.color;
              })

      var labels = groups.append("text")
            .attr("class", "label")
            .attr("x", function(d,i) {
              //set x right against the bar expect for some padding;
              // we'll align the end of the text against it
              return margins.left - 10
            })
            //make it as wide as the margin
            //.attr("width", margins.left)
            .attr("y", function(d,i) {
              //ToDo: How to more dynamically represent this?
              return yScale(i) + 21;
            })
            .style("line-height", "30px")
            .style("font-size", "14px")
            .style("text-anchor", "end")
            .text(function(d) {
              return d.name
            });
    </script>
  </body>
</html>

